# bus_berth_allocation

This repository contains the simulation model and the berth allocation algorithms used in a paper titled "Efficient Heuristic Methods for Berth Allocation at Multi-line, Multi-berth Curbside Bus Stops", which is currently being under review by "Transportation Research Part C".

## Installation

The required packages are listed in `requirements.txt`. Please use the package manager pip to install:

``
pip install -r requirements.txt
``

## Usage
The repository uses `mongodb` to store the numerical experiments results, and use the `sacred` package to manage the experiment results. The basic usage flow is as follows:

1. In `line_profile.py`, the bus line datasets used in the paper can be generated by calling the function `manual_add_to_db`. The datasets will then be added into `mongodb` database. By default, the line dataset will be stored in `line_profile` collection of `inputs` database.
2. For isolated-bus-stop cases, the `isolated_main_enumerate.py` will enumerate all the possible berth allocations and run the simulation to obtain the steady-state queueing delay metric. You can specify different queueing rules, line set no and so on. (Note that multiple threads can be used for parallel computing so as to speed up.) All the results will be saved in the `mongodb`, managed by `sacred`. By default, the simulation results will be stored in `runs` collection of `cx` database, where `x` is the berth number.
3. Given all the enumerated berth allocations simulated in step 2, you can run the `algo_main_for_enum.py` script, wherein you can specify the algorithm type (CNP method or Tan's method) and corresponding parameters. The algorithm will automatically retrieve the simulation results stored in the database. If no simulated berth allocation plan is found in the database, the simulation will be conducted immediately. The algorithm results will be stored in `runs` collection of `cx_res` database, where `x` is the berth number.
4. For near- and far-side stops, you can run `signal_main_enumerate.py` script. In addition to the isolated scenario, you can also specify the cycle length, buffer size and green ratio for near- and far-side stops.

## Feel free to ask me if you have any questions! :blush:

My email address is: <shenminyu@swufe.edu.cn>
